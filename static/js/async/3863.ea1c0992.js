"use strict";(self.webpackChunkFrostWood=self.webpackChunkFrostWood||[]).push([["3863"],{5324:function(e,n,t){t.r(n),t.d(n,{default:function(){return i}});var r=t(5893),c=t(65);function a(e){let n=Object.assign({h1:"h1",a:"a",h2:"h2",h3:"h3",pre:"pre",code:"code",div:"div",p:"p",ol:"ol",li:"li"},(0,c.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"剪贴板",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#剪贴板",children:"#"}),"剪贴板"]}),"\n",(0,r.jsxs)(n.h2,{id:"复制文本到剪贴板",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#复制文本到剪贴板",children:"#"}),"复制文本到剪贴板"]}),"\n",(0,r.jsxs)(n.h3,{id:"navigatorclipboardwritetext",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#navigatorclipboardwritetext",children:"#"}),"Navigator.clipboard.writeText"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:"",children:"const copyToClipboard = str => {\n  if (navigator && navigator.clipboard && navigator.clipboard.writeText)\n    return navigator.clipboard.writeText(str);\n  return Promise.reject('The Clipboard API is not available.');\n};\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"documentexeccommandcopy",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#documentexeccommandcopy",children:"#"}),"Document.execCommand('copy')"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:"",children:"const copyToClipboard = str => {\n  const el = document.createElement('textarea');\n  el.value = str;\n  el.setAttribute('readonly', '');\n  el.style.position = 'absolute';\n  el.style.left = '-9999px';\n  document.body.appendChild(el);\n  const selected =\n    document.getSelection().rangeCount > 0\n      ? document.getSelection().getRangeAt(0)\n      : false;\n  el.select();\n  document.execCommand('copy');\n  document.body.removeChild(el);\n  if (selected) {\n    document.getSelection().removeAllRanges();\n    document.getSelection().addRange(selected);\n  }\n};\n"})}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive warning",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsx)(n.div,{className:"rspress-directive-content",children:(0,r.jsx)(n.p,{children:"\n此方法并非在任何地方都有效，而只能作为用户操作的结果（例如在click事件侦听器内）。这是一项安全措施，旨在防止恶意网站未经用户同意将敏感数据复制到贴板。"})})]}),"\n",(0,r.jsxs)(n.h2,{id:"兼容性方案",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#兼容性方案",children:"#"}),"兼容性方案"]}),"\n",(0,r.jsx)(n.p,{children:"结合前面两种方法，复用已有代码："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:"",children:"// 复用第一个方法\nconst copyTextModern = str => {\n  if (navigator && navigator.clipboard && navigator.clipboard.writeText)\n    return navigator.clipboard.writeText(str);\n  return Promise.reject('The Clipboard API is not available.');\n};\n\n// 复用第二个方法并改造\nconst copyTextLegacy = str => {\n  try {\n    const el = document.createElement('textarea');\n    el.value = str;\n    el.setAttribute('readonly', '');\n    el.style.position = 'absolute';\n    el.style.left = '-9999px';\n    document.body.appendChild(el);\n    el.select();\n    const success = document.execCommand('copy');\n    document.body.removeChild(el);\n    \n    return success \n      ? Promise.resolve()\n      : Promise.reject('execCommand 复制失败');\n  } catch (err) {\n    return Promise.reject(err);\n  }\n};\n\nconst copyToClipboard = async (text) => {\n  try {\n    await copyTextModern(text);\n  } catch (err) {\n    await copyTextLegacy(text);\n  }\n};\n\n// 使用示例\ncopyToClipboard('要复制的文本')\n  .then(() => console.log('复制成功'))\n  .catch(err => console.error('复制失败:', err));\n"})}),"\n",(0,r.jsx)(n.p,{children:"这个方案的特点："}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"复用了前面定义的两种复制方法"}),"\n",(0,r.jsx)(n.li,{children:"优先使用现代的 Clipboard API"}),"\n",(0,r.jsx)(n.li,{children:"失败时自动降级使用 execCommand 方法"}),"\n",(0,r.jsx)(n.li,{children:"统一使用 Promise，失败时会抛出具体错误信息"}),"\n"]})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,c.ah)(),e.components);return n?(0,r.jsx)(n,Object.assign({},e,{children:(0,r.jsx)(a,e)})):a(e)}let i=o;o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["front-end%2Fcode-snippet%2F%E5%89%AA%E8%B4%B4%E6%9D%BF.mdx"]={toc:[{id:"复制文本到剪贴板",text:"复制文本到剪贴板",depth:2},{id:"navigatorclipboardwritetext",text:"Navigator.clipboard.writeText",depth:3},{id:"documentexeccommandcopy",text:"Document.execCommand('copy')",depth:3},{id:"兼容性方案",text:"兼容性方案",depth:2}],title:"剪贴板",frontmatter:{}}}}]);